{"ast":null,"code":"var _jsxFileName = \"/var/www/html/dummy_applications/3rd_party_login/src/components/Dashboard.component.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport CryptoJS from 'crypto-js';\nconst baseURL = \"http://localhost:5000/server\";\nconst Dashboard = () => {\n  const navigate = useNavigate();\n  const token = localStorage.getItem('token');\n  const [user, setUser] = useState({});\n\n  //logout handler\n  const handleLogout = () => {\n    const header = {\n      Authorization: `Bearer ${token}`\n    };\n    axios.get(`${baseURL}/logout`, {\n      headers: header\n    }).then(response => {\n      // console.log(response);\n      localStorage.removeItem(\"token\");\n      navigate('/login');\n    }).catch(err => console.log('error'));\n  };\n  useEffect(() => {\n    if (!token) {\n      navigate('/login');\n    }\n    const header = {\n      Authorization: `Bearer ${token}`\n    };\n    axios.get(`${baseURL}/dashboard`, {\n      headers: header\n    }).then(response => {\n      if (!response.data.user) {\n        localStorage.removeItem(\"token\");\n        navigate('/login');\n      }\n      var bytes = CryptoJS.AES.decrypt(response.data.user, process.env.REACT_APP_CRYPTO_SECRET_KEY);\n      var originalText = bytes.toString(CryptoJS.enc.Utf8);\n      setUser(JSON.parse(originalText));\n    }).catch(err => {\n      localStorage.removeItem(\"token\");\n      navigate('/login');\n    });\n  }, []);\n  return Object.keys(user).length > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 3\n    }\n  }, \"welcome \", user === null || user === void 0 ? void 0 : user.name, /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 4\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleLogout,\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 4\n    }\n  }, \"Logout\")) : '';\n};\nexport default Dashboard;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","axios","CryptoJS","baseURL","Dashboard","navigate","token","localStorage","getItem","user","setUser","handleLogout","header","Authorization","get","headers","then","response","removeItem","catch","err","console","log","data","bytes","AES","decrypt","process","env","REACT_APP_CRYPTO_SECRET_KEY","originalText","toString","enc","Utf8","JSON","parse","Object","keys","length","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","name","onClick","className"],"sources":["/var/www/html/dummy_applications/3rd_party_login/src/components/Dashboard.component.js"],"sourcesContent":["import React, {useEffect,useState} from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport CryptoJS from 'crypto-js';\nconst baseURL = \"http://localhost:5000/server\";\nconst Dashboard = () =>  {\n\tconst navigate = useNavigate();\n\tconst token = localStorage.getItem('token');\n\tconst [user,setUser] = useState({});\n\n\t//logout handler\n\tconst handleLogout = () =>{\n\t\tconst header = {Authorization:`Bearer ${token}`};\n\t\taxios.get(`${baseURL}/logout`,{headers:header})\n\t\t.then((response)=>{\n\t\t\t// console.log(response);\n\t\t\tlocalStorage.removeItem(\"token\");\n\t\t\tnavigate('/login');\n\t\t}).catch((err)=>console.log('error'));\n\t}\n\tuseEffect(\n\t\t() => {\n\t\t\tif(!token)\n\t\t\t{\n\t\t\t\tnavigate('/login');\n\t\t\t}\n\t\t\tconst header = {Authorization:`Bearer ${token}`};\n\t\t\taxios.get(`${baseURL}/dashboard`,{headers:header})\n\t\t\t.then((response)=>{\n\t\t\t\tif(!response.data.user) \n\t\t\t\t{localStorage.removeItem(\"token\"); navigate('/login');}\n\t\t\t\tvar bytes  = CryptoJS.AES.decrypt(response.data.user, process.env.REACT_APP_CRYPTO_SECRET_KEY);\n\t\t\t\tvar originalText = bytes.toString(CryptoJS.enc.Utf8);\n\t\t\t\tsetUser(JSON.parse(originalText));\n\t\t\t}).catch((err)=>{localStorage.removeItem(\"token\");navigate('/login');});\n\t\t\t},\n\t\t[]\n\t);\n\treturn (\n\t\tObject.keys(user).length>0?\n\t\t<div>\n\t\t\twelcome {user?.name}\n\t\t\t<br></br>\n\t\t\t<button onClick={handleLogout} className='btn btn-primary'>Logout</button>\n\t\t</div>\n\t\t:''\n\t);\n}\n  \nexport default Dashboard;\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}