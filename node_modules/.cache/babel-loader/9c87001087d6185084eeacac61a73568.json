{"ast":null,"code":"import CryptoJS from 'crypto-js';\nclass helper {\n  decryption(user) {\n    var bytes = CryptoJS.AES.decrypt(user, process.env.REACT_APP_CRYPTO_SECRET_KEY);\n    var originalText = bytes.toString(CryptoJS.enc.Utf8);\n    var parsedtext = JSON.parse(originalText);\n    return parsedtext;\n  }\n  checkRole(user, roleId) {\n    var _user$roles$;\n    const user_roleId = user === null || user === void 0 ? void 0 : (_user$roles$ = user.roles[0]) === null || _user$roles$ === void 0 ? void 0 : _user$roles$.id;\n    if (user_roleId === roleId) return true;\n    return false;\n  }\n  verifyRole(encryptedUser, roles) {\n    var _user$roles$2;\n    const user = this.decryption(encryptedUser);\n    if (Object.values(roles).includes(user === null || user === void 0 ? void 0 : (_user$roles$2 = user.roles[0]) === null || _user$roles$2 === void 0 ? void 0 : _user$roles$2.id)) {\n      return true;\n    }\n    return false;\n  }\n  checkPermission(user, permission) {\n    var _user$roles$3;\n    const permissions = user === null || user === void 0 ? void 0 : (_user$roles$3 = user.roles[0]) === null || _user$roles$3 === void 0 ? void 0 : _user$roles$3.permissions;\n    const allPermissions = [];\n    if (Array.isArray(permissions)) {\n      permissions.forEach(function (item, key) {\n        allPermissions.push(item.name);\n      });\n    }\n    if (allPermissions === null || allPermissions === void 0 ? void 0 : allPermissions.includes(permission)) {\n      return true;\n    } else {\n      return null;\n    }\n    ;\n  }\n  getCurrentUser() {\n    const user = localStorage.getItem('user');\n    const authUser = this.decryption(user);\n    return authUser;\n  }\n  getHeaders() {\n    const token = localStorage.getItem('token');\n    const headers = {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    };\n    return headers;\n  }\n  getAdminName() {\n    return 'Admin';\n  }\n  getAdminName() {\n    return 'Admin';\n  }\n}\nconst helpers = new helper();\nexport default helpers;","map":{"version":3,"names":["CryptoJS","helper","decryption","user","bytes","AES","decrypt","process","env","REACT_APP_CRYPTO_SECRET_KEY","originalText","toString","enc","Utf8","parsedtext","JSON","parse","checkRole","roleId","_user$roles$","user_roleId","roles","id","verifyRole","encryptedUser","_user$roles$2","Object","values","includes","checkPermission","permission","_user$roles$3","permissions","allPermissions","Array","isArray","forEach","item","key","push","name","getCurrentUser","localStorage","getItem","authUser","getHeaders","token","headers","Authorization","getAdminName","helpers"],"sources":["/var/www/html/dummy_applications/3rd_party/src/helpers/helper.js"],"sourcesContent":["import CryptoJS from 'crypto-js';\nclass helper{\n    decryption(user){\n        var bytes  = CryptoJS.AES.decrypt(user, process.env.REACT_APP_CRYPTO_SECRET_KEY);\n        var originalText = bytes.toString(CryptoJS.enc.Utf8);\n        var parsedtext = JSON.parse(originalText);\n        return parsedtext;\n    }\n    checkRole(user,roleId)\n    {\n        const user_roleId = user?.roles[0]?.id;\n        if(user_roleId === roleId) return true;\n        return false;\n    }\n    verifyRole(encryptedUser,roles)\n    {\n        const user = this.decryption(encryptedUser);\n        if(Object.values(roles).includes(user?.roles[0]?.id))\n        {\n            return true;\n        }\n        return false;\n    }\n    checkPermission(user,permission)\n    {\n        const permissions = user?.roles[0]?.permissions;\n        const allPermissions = [];\n        if(Array.isArray(permissions))\n        {\n            permissions.forEach(function(item,key){\n                allPermissions.push(item.name);\n            });\n        }\n        if(allPermissions?.includes(permission)) {\n            return true;\n        }else{\n            return null;\n        };\n    }\n    getCurrentUser()\n    {\n        const user = localStorage.getItem('user');\n        const authUser = this.decryption(user);\n        return authUser;\n    }\n    getHeaders() {\n        const token = localStorage.getItem('token');\n        const headers = {headers:{Authorization:`Bearer ${token}`}};\n        return headers;\n    }\n    getAdminName()\n    {\n        return 'Admin';\n    }\n    getAdminName()\n    {\n        return 'Admin';\n    }\n}\nconst helpers = new helper();\nexport default helpers;\n"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,WAAW;AAChC,MAAMC,MAAM;EACRC,UAAUA,CAACC,IAAI,EAAC;IACZ,IAAIC,KAAK,GAAIJ,QAAQ,CAACK,GAAG,CAACC,OAAO,CAACH,IAAI,EAAEI,OAAO,CAACC,GAAG,CAACC,2BAA2B,CAAC;IAChF,IAAIC,YAAY,GAAGN,KAAK,CAACO,QAAQ,CAACX,QAAQ,CAACY,GAAG,CAACC,IAAI,CAAC;IACpD,IAAIC,UAAU,GAAGC,IAAI,CAACC,KAAK,CAACN,YAAY,CAAC;IACzC,OAAOI,UAAU;EACrB;EACAG,SAASA,CAACd,IAAI,EAACe,MAAM,EACrB;IAAA,IAAAC,YAAA;IACI,MAAMC,WAAW,GAAGjB,IAAI,aAAJA,IAAI,wBAAAgB,YAAA,GAAJhB,IAAI,CAAEkB,KAAK,CAAC,CAAC,CAAC,cAAAF,YAAA,uBAAdA,YAAA,CAAgBG,EAAE;IACtC,IAAGF,WAAW,KAAKF,MAAM,EAAE,OAAO,IAAI;IACtC,OAAO,KAAK;EAChB;EACAK,UAAUA,CAACC,aAAa,EAACH,KAAK,EAC9B;IAAA,IAAAI,aAAA;IACI,MAAMtB,IAAI,GAAG,IAAI,CAACD,UAAU,CAACsB,aAAa,CAAC;IAC3C,IAAGE,MAAM,CAACC,MAAM,CAACN,KAAK,CAAC,CAACO,QAAQ,CAACzB,IAAI,aAAJA,IAAI,wBAAAsB,aAAA,GAAJtB,IAAI,CAAEkB,KAAK,CAAC,CAAC,CAAC,cAAAI,aAAA,uBAAdA,aAAA,CAAgBH,EAAE,CAAC,EACpD;MACI,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB;EACAO,eAAeA,CAAC1B,IAAI,EAAC2B,UAAU,EAC/B;IAAA,IAAAC,aAAA;IACI,MAAMC,WAAW,GAAG7B,IAAI,aAAJA,IAAI,wBAAA4B,aAAA,GAAJ5B,IAAI,CAAEkB,KAAK,CAAC,CAAC,CAAC,cAAAU,aAAA,uBAAdA,aAAA,CAAgBC,WAAW;IAC/C,MAAMC,cAAc,GAAG,EAAE;IACzB,IAAGC,KAAK,CAACC,OAAO,CAACH,WAAW,CAAC,EAC7B;MACIA,WAAW,CAACI,OAAO,CAAC,UAASC,IAAI,EAACC,GAAG,EAAC;QAClCL,cAAc,CAACM,IAAI,CAACF,IAAI,CAACG,IAAI,CAAC;MAClC,CAAC,CAAC;IACN;IACA,IAAGP,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEL,QAAQ,CAACE,UAAU,CAAC,EAAE;MACrC,OAAO,IAAI;IACf,CAAC,MAAI;MACD,OAAO,IAAI;IACf;IAAC;EACL;EACAW,cAAcA,CAAA,EACd;IACI,MAAMtC,IAAI,GAAGuC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;IACzC,MAAMC,QAAQ,GAAG,IAAI,CAAC1C,UAAU,CAACC,IAAI,CAAC;IACtC,OAAOyC,QAAQ;EACnB;EACAC,UAAUA,CAAA,EAAG;IACT,MAAMC,KAAK,GAAGJ,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAMI,OAAO,GAAG;MAACA,OAAO,EAAC;QAACC,aAAa,EAAC,UAAUF,KAAK;MAAE;IAAC,CAAC;IAC3D,OAAOC,OAAO;EAClB;EACAE,YAAYA,CAAA,EACZ;IACI,OAAO,OAAO;EAClB;EACAA,YAAYA,CAAA,EACZ;IACI,OAAO,OAAO;EAClB;AACJ;AACA,MAAMC,OAAO,GAAG,IAAIjD,MAAM,CAAC,CAAC;AAC5B,eAAeiD,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module"}